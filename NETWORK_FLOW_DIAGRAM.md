# Django WebSocket ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å›³

## ğŸŒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚   ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ    â”‚    â”‚   Route 53      â”‚    â”‚   CloudFront    â”‚
â”‚                 â”‚    â”‚   (DNS)         â”‚    â”‚   (CDN)         â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚   [Optional]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS Application Load Balancer            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Listener      â”‚  â”‚   Listener      â”‚  â”‚   Target Group  â”‚  â”‚
â”‚  â”‚   Port 80       â”‚  â”‚   Port 443      â”‚  â”‚   django-main   â”‚  â”‚
â”‚  â”‚   HTTP          â”‚  â”‚   HTTPS         â”‚  â”‚   Port 80       â”‚  â”‚
â”‚  â”‚   â†“ Redirect    â”‚  â”‚   â†“ Forward     â”‚  â”‚                 â”‚  â”‚
â”‚  â”‚   to HTTPS      â”‚  â”‚   to TG         â”‚  â”‚   Health: /health/â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Load Balance
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EC2 Instance(s)                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    Docker Network                           â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚â”‚
â”‚  â”‚  â”‚    Nginx    â”‚  â”‚   Django    â”‚  â”‚    Redis    â”‚         â”‚â”‚
â”‚  â”‚  â”‚   Port 80   â”‚  â”‚ + Daphne    â”‚  â”‚  Port 6379  â”‚         â”‚â”‚
â”‚  â”‚  â”‚             â”‚  â”‚  Port 8000  â”‚  â”‚             â”‚         â”‚â”‚
â”‚  â”‚  â”‚  Reverse    â”‚  â”‚             â”‚  â”‚   Channel   â”‚         â”‚â”‚
â”‚  â”‚  â”‚   Proxy     â”‚  â”‚  WebSocket  â”‚  â”‚    Layer    â”‚         â”‚â”‚
â”‚  â”‚  â”‚             â”‚  â”‚   Handler   â”‚  â”‚             â”‚         â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚â”‚
â”‚  â”‚           â”‚               â”‚               â”‚                â”‚â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚â”‚
â”‚  â”‚                           â”‚                                â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚â”‚
â”‚  â”‚  â”‚                PostgreSQL                         â”‚     â”‚â”‚
â”‚  â”‚  â”‚                Port 5432                          â”‚     â”‚â”‚
â”‚  â”‚  â”‚              Database Storage                     â”‚     â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ãƒ­ãƒ¼è©³ç´°

### 1. HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ãƒ­ãƒ¼

```
[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â†’ [ALB] â†’ [EC2:Nginx:80] â†’ [Django:8000] â†’ [PostgreSQL:5432]
     â”‚                                                          â†‘
     â”‚                                                          â”‚
     â””â”€â”€ POST /create/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         (æŠ•ç¨¿ä½œæˆ)
```

### 2. WebSocket æ¥ç¶šãƒ•ãƒ­ãƒ¼

```
[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] â†’ [ALB] â†’ [EC2:Nginx:80] â†’ [Django:8000] â†’ [Redis:6379]
     â”‚              â”‚         â”‚              â”‚              â”‚
     â”‚              â”‚         â”‚              â”‚              â”‚
     â–¼              â–¼         â–¼              â–¼              â–¼
   ws://       HTTPS/WSS   HTTP/WS     Daphne ASGI    Channel Layer
 connection   Termination  Upgrade      Consumer       Message Bus
```

### 3. ãƒ©ãƒ³ãƒ€ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡ãƒ•ãƒ­ãƒ¼

```
[Background Task] â†’ [Redis:6379] â†’ [Django Channels] â†’ [WebSocket] â†’ [ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ]
       â”‚                 â”‚              â”‚                 â”‚              â”‚
       â”‚                 â”‚              â”‚                 â”‚              â”‚
       â–¼                 â–¼              â–¼                 â–¼              â–¼
  Timer Task        Channel Layer   Consumer.send    ws.send()     Browser Update
  (5-20ç§’é–“éš”)      group_send()    to_client()      Message       DOM Update
```

## ğŸš¦ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ†æ•£ã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ALB ãƒªã‚¹ãƒŠãƒ¼ãƒ«ãƒ¼ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ALB Listener Rules                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚   Rule #100     â”‚    â”‚   Rule #200     â”‚                     â”‚
â”‚  â”‚   Priority      â”‚    â”‚   Priority      â”‚                     â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                     â”‚
â”‚  â”‚  Condition:     â”‚    â”‚  Condition:     â”‚                     â”‚
â”‚  â”‚  - Path: /ws/*  â”‚    â”‚  - Path: /healthâ”‚                     â”‚
â”‚  â”‚  - Header:      â”‚    â”‚                 â”‚                     â”‚
â”‚  â”‚    Connection   â”‚    â”‚  Action:        â”‚                     â”‚
â”‚  â”‚    = upgrade    â”‚    â”‚  â†’ Health TG    â”‚                     â”‚
â”‚  â”‚                 â”‚    â”‚    Port 8000    â”‚                     â”‚
â”‚  â”‚  Action:        â”‚    â”‚                 â”‚                     â”‚
â”‚  â”‚  â†’ Main TG      â”‚    â”‚                 â”‚                     â”‚
â”‚  â”‚    Port 80      â”‚    â”‚                 â”‚                     â”‚
â”‚  â”‚  (Sticky)       â”‚    â”‚                 â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                Default Rule                                 â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  All other traffic â†’ Main Target Group (Port 80)           â”‚â”‚
â”‚  â”‚  Static files, Django views, API endpoints                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ãƒãƒ¼ãƒˆã¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°

### å¤–éƒ¨â†’å†…éƒ¨ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°

| ã‚µãƒ¼ãƒ“ã‚¹ | å¤–éƒ¨ãƒãƒ¼ãƒˆ | å†…éƒ¨ãƒãƒ¼ãƒˆ | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ç”¨é€” |
|----------|------------|------------|------------|------|
| ALB | 80 | - | HTTP | HTTPâ†’HTTPS ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |
| ALB | 443 | - | HTTPS/WSS | ãƒ¡ã‚¤ãƒ³ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ |
| Nginx | - | 80 | HTTP/WS | ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚· |
| Django+Daphne | - | 8000 | HTTP/WS | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ |
| PostgreSQL | - | 5432 | TCP | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| Redis | - | 6379 | TCP | ã‚­ãƒ£ãƒƒã‚·ãƒ¥/Channel Layer |

### ãƒ—ãƒ­ãƒˆã‚³ãƒ«å¤‰æ›ãƒ•ãƒ­ãƒ¼

```
Client Browser           ALB              Nginx            Django+Daphne
      â”‚                  â”‚                 â”‚                     â”‚
      â”‚ HTTPS/WSS         â”‚ HTTP/WS         â”‚ HTTP/WS             â”‚
      â”‚ Port 443          â”‚ Port 80         â”‚ Port 8000           â”‚
      â”‚                  â”‚                 â”‚                     â”‚
      â”œâ”€â”€HTTP Requestâ”€â”€â”€â”€â–ºâ”œâ”€â”€HTTP Requestâ”€â”€â–ºâ”œâ”€â”€HTTP Requestâ”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚                  â”‚                 â”‚                     â”‚
      â”œâ”€â”€WebSocketâ”€â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€â”€WebSocketâ”€â”€â”€â”€â”€â–ºâ”œâ”€â”€WebSocketâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚  Upgrade          â”‚  Upgrade        â”‚  Upgrade            â”‚
      â”‚                  â”‚                 â”‚                     â”‚
      â”‚â—„â”€Responseâ”€â”€â”€â”€â”€â”€â”€â”€â—„â”‚â—„â”€Responseâ”€â”€â”€â”€â”€â”€â—„â”‚â—„â”€Responseâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
      â”‚                  â”‚                 â”‚                     â”‚
      â”‚â—„â”€WS Messageâ”€â”€â”€â”€â”€â”€â—„â”‚â—„â”€WS Messageâ”€â”€â”€â”€â—„â”‚â—„â”€WS Messageâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

## ğŸ”§ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Security Groups                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚    ALB Security     â”‚    â”‚   EC2 Security      â”‚              â”‚
â”‚  â”‚      Group          â”‚    â”‚     Group           â”‚              â”‚
â”‚  â”‚                     â”‚    â”‚                     â”‚              â”‚
â”‚  â”‚  Inbound:           â”‚    â”‚  Inbound:           â”‚              â”‚
â”‚  â”‚  - Port 80  (HTTP)  â”‚    â”‚  - Port 80 (from   â”‚              â”‚
â”‚  â”‚    from 0.0.0.0/0   â”‚    â”‚    ALB SG only)     â”‚              â”‚
â”‚  â”‚  - Port 443 (HTTPS) â”‚    â”‚  - Port 8000 (from â”‚              â”‚
â”‚  â”‚    from 0.0.0.0/0   â”‚    â”‚    ALB SG only)     â”‚              â”‚
â”‚  â”‚                     â”‚    â”‚  - Port 22 (SSH)    â”‚              â”‚
â”‚  â”‚  Outbound:          â”‚    â”‚    from Admin IP    â”‚              â”‚
â”‚  â”‚  - All traffic      â”‚    â”‚                     â”‚              â”‚
â”‚  â”‚    to EC2 SG        â”‚    â”‚  Outbound:          â”‚              â”‚
â”‚  â”‚                     â”‚    â”‚  - All traffic      â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¨ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°

### Auto Scaling ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Auto Scaling Group                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   EC2-1     â”‚  â”‚   EC2-2     â”‚  â”‚   EC2-3     â”‚              â”‚
â”‚  â”‚  (Primary)  â”‚  â”‚  (Scale)    â”‚  â”‚  (Scale)    â”‚              â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚              â”‚
â”‚  â”‚  Target:    â”‚  â”‚  Target:    â”‚  â”‚  Target:    â”‚              â”‚
â”‚  â”‚  Healthy    â”‚  â”‚  Healthy    â”‚  â”‚  Healthy    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                 â”‚                 â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                           â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚              ALB Target Group                     â”‚          â”‚
â”‚  â”‚                                                   â”‚          â”‚
â”‚  â”‚  Health Check: /health/ every 30s                â”‚          â”‚
â”‚  â”‚  Sticky Sessions: Enabled (WebSocket)            â”‚          â”‚
â”‚  â”‚  Deregistration Delay: 300s                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### WebSocket ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 WebSocket Session Stickiness                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Client A â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚     â”‚                              â”‚                          â”‚
â”‚     â”‚ Initial HTTP Request         â”‚                          â”‚
â”‚     â”‚ (Gets Cookie)               â”‚                          â”‚
â”‚     â–¼                              â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   EC2-1     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”‚   EC2-2     â”‚          â”‚
â”‚  â”‚             â”‚                   â”‚  â”‚             â”‚          â”‚
â”‚  â”‚  WebSocket  â”‚                   â”‚  â”‚  WebSocket  â”‚          â”‚
â”‚  â”‚  Connection â”‚                   â”‚  â”‚  Connection â”‚          â”‚
â”‚  â”‚  (Sticky)   â”‚                   â”‚  â”‚             â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                    â”‚                          â”‚
â”‚  Client B â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚     â”‚                                                         â”‚
â”‚     â”‚ Different Cookie                                        â”‚
â”‚     â–¼                                                         â”‚
â”‚  Routes to available instance                                 â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã“ã®å›³ã«ã‚ˆã‚Šã€Django WebSocketã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Œå…¨ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ALBã‚’é€šã˜ãŸãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°ã€WebSocketã®ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®šã€ãã—ã¦ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥ã¾ã§ã€ã™ã¹ã¦ã®è¦ç´ ãŒé€£æºã—ã¦å‹•ä½œã—ã¾ã™ã€‚
